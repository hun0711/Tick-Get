<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="back.spring.final_back.member.repository.SignUpDao">
	<insert id="memberInsert" parameterType="map">
		INSERT INTO member(
		<!-- member_no, -->
		<!-- member_domain, -->
		member_id,
		member_password,
		member_name,
		<!-- member_age, -->
		member_birth,
		member_email,
		member_gender,
		member_mobile,
		member_nickname,
		<!-- member_profile_image, -->
		member_register_date,
		member_zipcode,
		member_address,
		member_addr_detail)
		VALUES(
		<!-- <if test="memberNo!= null"> #{memberNo} </if> -->
		<!-- <if test="memberDomain!= null"> #{memberDomain} </if> -->
		<if test="memberId!= null">
			#{memberId}
		</if>
		<if test="memberPassword!= null">
			,#{memberPassword}
		</if>
		<if test="memberName!= null">
			,#{memberName}
		</if>
		<!-- <if test="memberAge!= null"> ,#{memberAge} </if> -->
		<if test="memberBirth!= null">
			,#{memberBirth}
		</if>
		<if test="memberEmail!= null">
			,#{memberEmail}
		</if>
		<if test="memberGender!= null">
			,#{memberGender}
		</if>
		<if test="memberMobile!= null">
			,#{memberMobile}
		</if>
		<if test="memberNickname!= null">
			,#{memberNickname}
		</if>
		<!-- <if test="memberProfileImage!= null"> ,#{memberProfileImage} </if> -->
		<if test="memberRegisterDate == null">
			,CURDATE()
		</if>
		<if test="memberZipcode!= null">
			,#{memberZipcode}
		</if>
		<if test="memberAddress!= null">
			,#{memberAddress}
		</if>
		<if test="memberAddrDetail!= null">
			,#{memberAddrDetail}
		</if>
		)
	</insert>

	<select id="memberList" parameterType="java.util.HashMap"
		resultType="map">
		SELECT
		member_no,
		member_domain,
		member_id,
		member_password,
		member_name,
		member_age,
		member_birth,
		member_email,
		member_gender,
		member_mobile,
		member_nickname,
		member_profile_image,
		member_register_date,
		member_zipcode,
		member_address,
		member_addr_detail
		FROM member
		<where>
		<!-- 아이디, 이메일, 닉네임 중복 확인 -->
			<if test='memberId!=null and memberId.length()>0'>
				AND member_id = #{memberId}
			</if>
			<if test='memberEmail!=null and memberEmail.length()>0'>
				AND member_email = #{memberEmail}
				<if test='id != null'>AND member_id != #{id}</if>
			</if>
			<if test='memberNickname!=null and memberNickname.length()>0'>
				AND member_nickname = #{memberNickname}
				<if test='id != null'>AND member_id != #{id}</if>
			</if>
		</where>
	</select>
	
	<!-- 회원 정보 update -->
	<update id="memberUpdate" parameterType="java.util.HashMap">
		  UPDATE member
		  SET 
		    member_password = #{memberPassword},
		    member_name = #{memberName},
		    member_email = #{memberEmail},
		    member_mobile = #{memberMobile},
		    member_zipcode = #{memberZipcode},
		    member_address = #{memberAddress},
		    member_addr_detail = #{memberAddrDetail}
		  WHERE member_Id = #{memberId}
	</update>
	
	<!-- 비밀번호 update -->
	<update id="changePwUpdate" parameterType="java.util.HashMap">
		UPDATE member
		SET
		member_password = #{memberPassword}
		WHERE member_Id = #{memberId}
	</update>
</mapper>