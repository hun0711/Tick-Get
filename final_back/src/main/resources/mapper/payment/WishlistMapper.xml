<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="back.spring.final_back.payment.repository.WishlistDao">

<!-- 위시리스트 조회 -->
<select id="wishlistSelect" parameterType="WishlistDto" resultType="WishlistDto">
  select * from wishlist_data
   where member_no = #{memberNo}
</select>


<!-- 위시리스트 추가 -->
<insert id="wishlistAdd" parameterType="WishlistDto">

  insert into wishlist_data (wishlist_title,wishlist_price,wishlist_category,board_mk_no,member_no)
 <choose>
    <!-- 마켓 게시판에서 위시리스트 추가할 경우  -->
    <when test='wishlistCategory!=null and wishlistCategory.equals("market")'>
      values (#{wishlistTitle},#{wishlistPrice},#{wishlistCategory},#{boardMkNo},#{memberNo})
    </when>
    <otherwise>
      values (#{wishlistTitle},#{wishlistPrice},#{wishlistCategory},#{boardMkNo},null)
    </otherwise>
  </choose>
</insert>





<!-- 페스티벌 페이지에서 위시리스트 추가할 경우 
    <when test='wishlistCategory!=null and wishlistCategory.equals("fest_main")'>
    </when> -->



<!-- 위시리스트 제거 -->
<delete id="wishlistDelete" parameterType="WishlistDto">
    DELETE FROM wishlist_data
    <where>
        <choose>
        <!-- 제거할 상품의 카테고리가 마켓게시판인 경우 -->
            <when test="wishlistCategory == 'board_market' and boardMkNo != null and boardMkNo > 0">
                AND board_mk_no = #{boardMkNo}
            </when>
            <!-- 페스티벌 페이지인 경우  -->
            <when test="wishlistCategory == 'fest_main'">
                AND fest_main_no IS NOT NULL
            </when>
            <otherwise>
                AND 1=2 <!-- 두 가지 경우가 모두 아니면 삭제X  -->
            </otherwise>
        </choose>
    </where>
</delete>





</mapper>